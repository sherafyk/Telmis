services:
  emby:
    image: lscr.io/linuxserver/emby:latest
    container_name: emby
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
      - UMASK=${UMASK}
    volumes:
      - ${CONFIG_DIR}/emby:/config
      - ${DATA_DIR}/media/movies:/data/movies:ro
      - ${DATA_DIR}/media/tv:/data/tv:ro
    ports:
      - ${EMBY_HTTP_PORT}:8096
    restart: unless-stopped
    networks:
      - media
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

  sonarr:
    image: lscr.io/linuxserver/sonarr:latest
    container_name: sonarr
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
      - UMASK=${UMASK}
    volumes:
      - ${CONFIG_DIR}/sonarr:/config
      - ${DATA_DIR}:/data
    ports:
      - ${SONARR_PORT}:8989
    restart: unless-stopped
    networks:
      - media
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

  radarr:
    image: lscr.io/linuxserver/radarr:latest
    container_name: radarr
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
      - UMASK=${UMASK}
    volumes:
      - ${CONFIG_DIR}/radarr:/config
      - ${DATA_DIR}:/data
    ports:
      - ${RADARR_PORT}:7878
    restart: unless-stopped
    networks:
      - media
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

  prowlarr:
    image: lscr.io/linuxserver/prowlarr:latest
    container_name: prowlarr
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
      - UMASK=${UMASK}
    volumes:
      - ${CONFIG_DIR}/prowlarr:/config
    ports:
      - ${PROWLARR_PORT}:9696
    restart: unless-stopped
    networks:
      - media
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

  gluetun:
    image: qmcgaw/gluetun:latest
    container_name: gluetun
    environment:
      - VPN_SERVICE_PROVIDER=nordvpn
      - VPN_TYPE=${VPN_TYPE}
      - OPENVPN_USER=${NORDVPN_USER}
      - OPENVPN_PASSWORD=${NORDVPN_PASSWORD}
      - WIREGUARD_PRIVATE_KEY=${NORDVPN_WIREGUARD_PRIVATE_KEY}
      - WIREGUARD_ADDRESSES=${NORDVPN_WIREGUARD_ADDRESSES}
      - SERVER_COUNTRIES=${VPN_SERVER_COUNTRIES}
      - FIREWALL_INPUT_PORTS=${QBITTORRENT_WEBUI_PORT},${QBITTORRENT_PORT}
    volumes:
      - ${CONFIG_DIR}/gluetun:/gluetun
    ports:
      - ${QBITTORRENT_WEBUI_PORT}:${QBITTORRENT_WEBUI_PORT}
      - ${QBITTORRENT_PORT}:${QBITTORRENT_PORT}/tcp
      - ${QBITTORRENT_PORT}:${QBITTORRENT_PORT}/udp
    restart: unless-stopped
    networks:
      - media
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

  qbittorrent:
    image: lscr.io/linuxserver/qbittorrent:latest
    container_name: qbittorrent
    network_mode: "service:gluetun"
    depends_on:
      - gluetun
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
      - UMASK=${UMASK}
      - WEBUI_PORT=${QBITTORRENT_WEBUI_PORT}
    volumes:
      - ${CONFIG_DIR}/qbittorrent:/config
      - ${DATA_DIR}:/data
    restart: unless-stopped
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

  flaresolverr:
    image: ghcr.io/flaresolverr/flaresolverr:latest
    container_name: flaresolverr
    profiles:
      - flaresolverr
    environment:
      - TZ=${TZ}
    ports:
      - 8191:8191
    restart: unless-stopped
    networks:
      - media
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

  jackett:
    image: lscr.io/linuxserver/jackett:latest
    container_name: jackett
    profiles:
      - jackett
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
      - UMASK=${UMASK}
    volumes:
      - ${CONFIG_DIR}/jackett:/config
    ports:
      - ${JACKETT_PORT}:9117
    restart: unless-stopped
    networks:
      - media
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"

networks:
  media:
    driver: bridge
